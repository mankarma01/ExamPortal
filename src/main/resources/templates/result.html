<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{include/head}" >
  <title>Home</title>
</head>

<body>

  <!-- ======= Header ======= -->
  <header th:insert="~{include/header}"  id=s"header" class="header fixed-top d-flex align-items-center"></header>
  <!-- End Header -->

  <!-- ======= Sidebar ======= -->
  <aside id="sidebar" class="sidebar" th:insert="~{include/sidebar}"></aside><!-- End Sidebar-->

  <main id="main" class="main">
    <h3>Result Report</h3>




    <section class="section">
      <div class="row mb-3">
        <div class="col-lg-12">

          <div class="row">

          <div class="col-md-3">
            <label for="examStatus" class="form-label">Result Status</label>
            <input type="hidden" id="examId" name="examId" value="0">
            <select id="examStatus" name="examStatus" class="form-select">
              <option selected>Complete</option>
              <option selected>Running</option>
              <option selected>All</option>
            </select>
          </div>

          <div class="col-md-3">
            <label for="minimumMarks" class="form-label">Minimum Marks</label>
            <select id="minimumMarks" name="minimumMarks" class="form-select">
              <option >10</option>
              <option >15</option>
              <option selected>20</option>
              <option >25</option>
            </select>
          </div>

          </div>

          <div class="card">
            <div class="card-body">

              <table class="table datatable" id="resultTable">
                <thead>
                <tr>
                  <th>No.</th>
                  <th>Student Name</th>
                  <th>Mobile</th>
                  <th>Email</th>
                  <th>Collage</th>
                  <th>Exam</th>
                  <th>Date</th>
                  <th>correct</th>
                  <th>wrong</th>
                  <th>skip</th>
                  <th>next</th>
                  <th data-type="date" data-format="YYYY/DD/MM">startTime</th>
                  <th data-type="date" data-format="YYYY/DD/MM">endTime</th>
                  <th>status</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
              <!-- End Table with stripped rows -->

            </div>
          </div>

        </div>
      </div>
    </section>

  </main>


  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer" th:insert="~{include/footer}">

  </footer>

  <script>
    $(document).ready(function () {

        // Fetch data from the API
        $.ajax({
            url: baseUrl + 'resultAPI/getAll', // Replace with the correct endpoint
            method: 'GET',
            success: function (response) {
                if (response.result) {
                    let tableBody = '';

                    // Iterate through the data and generate table rows
                    response.data.forEach(function (item, index) {
                        const student = item.student;
                        const exam = item.exam;

                        tableBody += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${student.name || '-'}</td>
                                <td>${student.mobile || '-'}</td>
                                <td>${student.email || '-'}</td>
                                <td>${student.collageName || '-'}</td>
                                <td>${exam.title || '-'}</td>
                                <td>${exam.examDate || '-'}</td>
                                <td>${item.correct || 0}</td>
                                <td>${item.wrong || 0}</td>
                                <td>${item.skip || 0}</td>
                                <td>${item.next || '-'}</td>
                                <td>${item.startTime || '-'}</td>
                                <td>${item.endTime || '-'}</td>
                                <td>${item.isActive ? 'Running' : 'Completed'}</td>
                            </tr>
                        `;
                    });

                    // Append generated rows to the table body
                    $('#resultTable tbody').html(tableBody);

                } else {
                    alert('Error: ' + response.message);
                }
            },
            error: function (xhr, status, error) {
                console.error('Error fetching data:', status, error);
                alert('Failed to load data from server.');
            }
        });
    });
  </script>

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <div  th:insert="~{include/vendor-js}"></div>
</body>

</html>